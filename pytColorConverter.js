'use strict'

var namedColors = {
	lightpink: "rgb(255,182,193)",
	pink: "rgb(255,192,203)",
	crimson: "rgb(220,020,60"),
	lavenderblush: "rgb(255,240,245)",
	palevioletred: "rgb(219,112,147)",
	hotpink: "rgb(255,105,180)",
	deeppink: "rgb(255,020,147)",
	mediumvioletred: "rgb(199,021,133)",
	orchid: "rgb(218,112,214)",
	thistle: "rgb(216,191,216)",
	plum: "rgb(221,160,221)",
	violet: "rgb(238,130,238)",
	fuchsia: "rgb(255,000,255)",
	darkmagenta: "rgb(139,000,139)",
	purple: "rgb(128,000,128)",
	mediumorchid: "rgb(186,085,211)",
	darkviolet: "rgb(148,000,211)",
	darkorchid: "rgb(153,050,204)",
	indigo: "rgb(075,000,130)",
	blueviolet: "rgb(138,043,226)",
	mediumpurple: "rgb(147,112,219)",
	mediumslateblue: "rgb(123,104,238)",
	slateblue: "rgb(106,090,205)",
	darkslateblue: "rgb(072,061,139)",
	ghostwhite: "rgb(248,248,255)",
	lavender: "rgb(230,230,250)",
	blue: "rgb(000,000,255)",
	mediumblue: "rgb(000,000,205)",
	darkblue: "rgb(000,000,139)",
	navy: "rgb(000,000,128)",
	midnightblue: "rgb(025,025,112)",
	royalblue: "rgb(065,105,225)",
	cornflowerblue: "rgb(100,149,237)",
	lightsteelblue: "rgb(176,196,222)",
	lightslategray: "rgb(119,136,153)",
	slategray: "rgb(112,128,144)",
	dodgerblue: "rgb(030,144,255)",
	aliceblue: "rgb(240,248,255)",
	steelblue: "rgb(070,130,180)",
	lightskyblue: "rgb(135,206,250)",
	skyblue: "rgb(135,206,235)",
	deepskyblue: "rgb(000,191,255)",
	lightblue: "rgb(173,216,230)",
	powderblue: "rgb(176,224,230)",
	cadetblue: "rgb(095,158,160)",
	darkturquoise: "rgb(000,206,209)",
	azure: "rgb(240,255,255)",
	lightcyan: "rgb(224,255,255)",
	paleturquoise: "rgb(175,238,238)",
	aqua: "rgb(000,255,255)",
	aqua: "rgb(000,255,255)",
	darkcyan: "rgb(000,139,139)",
	teal: "rgb(000,128,128)",
	darkslategray: "rgb(047,079,079)",
	mediumturquoise: "rgb(072,209,204)",
	lightseagreen: "rgb(032,178,170)",
	turquoise: "rgb(064,224,208)",
	aquamarine: "rgb(127,255,212)",
	mediumaquamarine: "rgb(102,205,170)",
	mediumspringgreen: "rgb(000,250,154)",
	mintcream: "rgb(245,255,250)",
	springgreen: "rgb(000,255,127)",
	mediumseagreen: "rgb(060,179,113)",
	seagreen: "rgb(046,139,087)",
	honeydew: "rgb(240,255,240)",
	darkseagreen: "rgb(143,188,143)",
	palegreen: "rgb(152,251,152)",
	lightgreen: "rgb(144,238,144)",
	limegreen: "rgb(050,205,050)",
	lime: "rgb(000,255,000)",
	forestgreen: "rgb(034,139,034)",
	green: "rgb(000,128,000)",
	darkgreen: "rgb(000,100,000)",
	lawngreen: "rgb(124,252,000)",
	chartreuse: "rgb(127,255,000)",
	greenyellow: "rgb(173,255,047)",
	darkolivegreen: "rgb(085,107,047)",
	yellowgreen: "rgb(154,205,050)",
	olivedrab: "rgb(107,142,035)",
	ivory: "rgb(255,255,240)",
	beige: "rgb(245,245,220)",
	lightyellow: "rgb(255,255,224)",
	lightgoldenrodyellow: "rgb(250,250,210)",
	yellow: "rgb(255,255,000)",
	olive: "rgb(128,128,000)",
	darkkhaki: "rgb(189,183,107)",
	palegoldenrod: "rgb(238,232,170)",
	lemonchiffon: "rgb(255,250,205)",
	khaki: "rgb(240,230,140)",
	gold: "rgb(255,215,000)",
	cornsilk: "rgb(255,248,220)",
	goldenrod: "rgb(218,165,032)",
	darkgoldenrod: "rgb(184,134,011)",
	floralwhite: "rgb(255,250,240)",
	oldlace: "rgb(253,245,230)",
	wheat: "rgb(245,222,179)",
	orange: "rgb(255,165,000)",
	moccasin: "rgb(255,228,181)",
	papayawhip: "rgb(255,239,213)",
	blanchedalmond: "rgb(255,235,205)",
	navajowhite: "rgb(255,222,173)",
	antiquewhite: "rgb(250,235,215)",
	tan: "rgb(210,180,140)",
	burlywood: "rgb(222,184,135)",
	darkorange: "rgb(255,140,000)",
	bisque: "rgb(255,228,196)",
	linen: "rgb(250,240,230)",
	peru: "rgb(205,133,063)",
	peachpuff: "rgb(255,218,185)",
	sandybrown: "rgb(244,164,096)",
	chocolate: "rgb(210,105,030)",
	saddlebrown: "rgb(139,069,019)",
	seashell: "rgb(255,245,238)",
	sienna: "rgb(160,082,045)",
	lightsalmon: "rgb(255,160,122)",
	coral: "rgb(255,127,080)",
	orangered: "rgb(255,069,000)",
	darksalmon: "rgb(233,150,122)",
	tomato: "rgb(255,099,071)",
	salmon: "rgb(250,128,114)",
	mistyrose: "rgb(255,228,225)",
	lightcoral: "rgb(240,128,128)",
	snow: "rgb(255,250,250)",
	rosybrown: "rgb(188,143,143)",
	indianred: "rgb(205,092,092)",
	red: "rgb(255,000,000)",
	brown: "rgb(165,042,042)",
	firebrick: "rgb(178,034,034)",
	darkred: "rgb(139,000,000)",
	maroon: "rgb(128,000,000)",
	white: "rgb(255,255,255)",
	whitesmoke: "rgb(245,245,245)",
	gainsboro: "rgb(220,220,220)",
	lightgrey: "rgb(211,211,211)",
	silver: "rgb(192,192,192)",
	darkgray: "rgb(169,169,169)",
	gray: "rgb(128,128,128)",
	dimgray: "rgb(105,105,105)",
	black: "rgb(000,000,000)"
};

var rgbFromNamedColor = function (color) {
	var colorIndex = Object.keys(namedColors).indexOf(color);

	if (colorIndex != -1) {
		return namedColors[Object.keys(namedColors)[colorIndex]];
	} else {
		return false;
	}
};

var RGBregex = /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/;

var HEXregex = /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/;

var colorToStrippedRGB = function(regexMatch, radix) {
	if (radix != 10 && radix != 16) {
		throw ('error in pytColorConverter.colorToStrippedRGB, invalid radix')
	}
	var r = parseInt(regexMatch[1], radix);
	var g = parseInt(regexMatch[2], radix);
	var b = parseInt(regexMatch[3], radix);
	if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {
		return [r, g, b];
	} else {
		throw ('error in pytColorConverter.colorToStrippedRGB, invalid regexMatch value')
	};
}

var pytColorConverter = function (input) {
	input = input.toLowerCase();

	if (rgbFromNamedColor(input)) {
		input = rgbFromNamedColor(input);
	} else {
		input = input.replace(/^\s*#|\s*$/g, "");
		if (input.length === 3) {
			input = input.replace(/(.)/g, "$1$1");
		}
	}

	if (RGBregex.exec(input)) {
		return colorToStrippedRGB(RGBregex.exec(input), 10)
	} else if (HEXregex.exec(input)) {
		return colorToStrippedRGB(HEXregex.exec(input), 16)
	} else {
		throw ('error in pytColorConverter: colors must be named colors, rgb, or hex values')
	}
};

module.exports = pytColorConverter;
